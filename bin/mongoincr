#!/bin/bash

mongo <<\EOF
	
db.createCollection('counters');

db.counters.insert({_id:'id', sequence_value:5000});

db.system.js.save({

    _id: 'getNextSequenceValue',
    value : function (sequenceName){

	   var sequenceDocument = db.counters.findAndModify({

	        query:{_id: sequenceName },
	        update: {$inc:{sequence_value:1}},
	        new:true
	    });

	   return sequenceDocument.sequence_value;
	}
});	
EOF